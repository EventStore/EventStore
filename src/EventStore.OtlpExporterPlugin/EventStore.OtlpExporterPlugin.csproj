<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">
	<PropertyGroup>
		<TargetFramework>net8.0</TargetFramework>
		<Platforms>x64</Platforms>
		<OutputType>Library</OutputType>
		<GenerateAssemblyInfo>true</GenerateAssemblyInfo>
		<ProduceReferenceAssembly>false</ProduceReferenceAssembly>
		<Nullable>enable</Nullable>
		<EnableDynamicLoading>true</EnableDynamicLoading>
	</PropertyGroup>
	<PropertyGroup>
		<CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
	</PropertyGroup>
	<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|x64' ">
		<DebugSymbols>true</DebugSymbols>
	</PropertyGroup>
	<ItemGroup>
		<PackageReference Include="OpenTelemetry.Exporter.OpenTelemetryProtocol" Version="1.4.0-rc.1">
			<GeneratePathProperty>true</GeneratePathProperty>
			<ExcludeAssets>all</ExcludeAssets>
		</PackageReference>

		<Reference Include="$(PkgOpenTelemetry_Exporter_OpenTelemetryProtocol)\lib\net6.0\OpenTelemetry.Exporter.OpenTelemetryProtocol.dll">
			<Private>true</Private>
		</Reference>

		<PackageReference Include="OpenTelemetry.Extensions.Hosting" Version="1.4.0-rc.1">
			<ExcludeAssets>runtime</ExcludeAssets>
		</PackageReference>
	</ItemGroup>
	<ItemGroup>
		<None Update="otlp-exporter-example.yaml">
		  <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
		</None>
		<None Update="otlp-exporter-example.json">
			<CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
		</None>
	</ItemGroup>

	<Target Name="PublishPlugin" AfterTargets="Publish">
		<ItemGroup>
			<PluginOutputFiles Include="$(PublishDir)\LICENSE.md" />
			<PluginOutputFiles Include="$(PublishDir)\NOTICE.html" />
			<PluginOutputFiles Include="$(PublishDir)\*.json" />
			<PluginOutputFiles Include="$(PublishDir)\*.dll" />
			<PluginOutputFiles Include="$(PublishDir)\*.xml" />
		</ItemGroup>
		<Copy SourceFiles="@(PluginOutputFiles)" DestinationFolder="$(PublishDir)/package" />
	</Target>
</Project>
